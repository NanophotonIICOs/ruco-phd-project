\documentclass[margin=0.5mm]{standalone}
\usepackage[pdf]{pstricks}
\usepackage{auto-pst-pdf}
\usepackage{pst-optexp}
\usepackage{pstricks,pst-slpe} 

\begin{document}
\begin{pspicture}(10,5)
\pnode(1.5,1){LASER}
\pnode(6,1){SAMPLE}
\pnode(1,2.5){MIRROR}.
\pnode(8,2.5){MONOCHROMATOR}
\pnode(8,2.5){SLIT1}
\pnode(8.0,2.5){MM1}
\pnode(8.0,7){MM2}
\pnode(8.6,3.5){G1}
\pnode(9.25,7){MM3}
\pnode(9.25,2.5){MM4}
\pnode(9.75,2.5){DETECTOR}
\pnode(5,2.5){L1}
\newpsstyle{VariableStyle}{linewidth=0.7\pslinewidth,arrowsize=0.1,offset=-2,arrowscale=1,arrows=<->}

%\psset{mirrortype=extended, mirrordepth=0.15, variable}
\optbox[position=start, innerlabel,compname=LS](LASER)(SAMPLE){}
\pinhole[innerheight=0.2,phwidth=0.1](LASER)(3,1){ }
\opttripole[labelangle=-90,compname=SAM](LASER)(SAMPLE)(MIRROR){%
	\psframe[fillstyle=solid,fillcolor=gray!50](-0.3,0)(0.3,0.2)
	\psline(-0.3,0.1)(-0.5,0.1)(-0.5,0.5)(0.5,0.5)(0.5,0.1)(0.3,0.1)}{\color{blue}Sample}
\mirror[mirrortype=extended,mirrorwidth=0.5, mirrordepth=0.2,labelangle=35,labeloffset=-0.75,variable,compname=M1](SAMPLE)(MIRROR)(MONOCHROMATOR){}



%\optplate[position=0.7,compname=BS](M2)(L1){BS}
%\optbox[position=end, optboxsize=1 3.5,labeloffset=2, labelref=relgrav,compshift=0.75,compname=MONO](MIRROR)(MONOCHROMATOR){}  

\lens[abspos=4.1, n=1.2,labeloffset=-0.8,compname=L1](MIRROR)(SLIT1) {}

\pinhole[innerheight=0.05,phwidth=-0.05,abspos=2.7,compname=SLIT](L1)(MM1){ }
\mirror[mirrorwidth=0.4,mirrortype=extended, mirrordepth=0.1](MIRROR)(MM1)(MM2)
\mirror[mirrortype=extended, mirrorwidth=0.5,mirrorradius=1.5,mirrordepth=0.1](MM1)(MM2)(G1)
\optgrating[gratingwidth=0.4, variable](MM2)(G1)(MM3)
\mirror[mirrortype=extended, mirrorwidth=0.5,mirrorradius=4,mirrordepth=0.1](G1)(MM3)(MM4)
\mirror[mirrorwidth=0.4,mirrortype=extended, mirrordepth=0.1](MM3)(MM4)(DETECTOR)
\pinhole[innerheight=0.05,phwidth=0.05,abspos=0.4](MM4)(DETECTOR){ }
\psframe[linewidth=0.01](7.7,1.5)(9.65,7.5)




\optdetector[position=end,compname=DET,detsize=0.4 0.4,label=0.4 180 l](DETECTOR)(DETECTOR){}
\addtopsstyle{Beam}{beamwidth=0.2,fillstyle=solid,fillcolor=red!50!white, linecolor=red,opacity = 0.5,beaminside=false}
\drawwidebeam{1-6}



\drawbeam[fillstyle=solid,opacity=0.2, linecolor=red!70,linewidth=0.04,beaminside=false]{6-9}
\definecolor[ps]{bl}{rgb}{%
	tx@addDict begin Red Green Blue end}%

\addtopsstyle{Beam}{linecolor=bl, fillcolor=bl,linewidth=0.5\pslinewidth}
\multido{\i=0+1}{30}{%
	\pstVerb{%
		\i\space 700 400 sub 19 div mul 400 add
		tx@addDict begin wavelengthToRGB end }%
	\drawwidebeam[beamwidth=0.03,beamangle=\i\space 0.5 mul 5 sub,fillstyle=solid]{9-}%
}%


\end{pspicture}

\end{document}
